<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Time</span><span class="hs-operator">.</span><span class="hs-identifier">JapaneseCalendar</span><span class="hs-operator">.</span><span class="hs-identifier">SolarTerm</span><span>
</span><a name="line-2"></a><span>  </span><span class="hs-special">(</span><span> </span><a href="Data.Time.JapaneseCalendar.SolarTerm.html#SolarTerm"><span class="hs-identifier hs-type">SolarTerm</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-3"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Data.Time.JapaneseCalendar.SolarTerm.html#solarTermToJapaneseName"><span class="hs-identifier hs-var">solarTermToJapaneseName</span></a><span>
</span><a name="line-4"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Data.Time.JapaneseCalendar.SolarTerm.html#solarTermFromJapaneseName"><span class="hs-identifier hs-var">solarTermFromJapaneseName</span></a><span>
</span><a name="line-5"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Data.Time.JapaneseCalendar.SolarTerm.html#isSegmentPoint"><span class="hs-identifier hs-var">isSegmentPoint</span></a><span>
</span><a name="line-6"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Data.Time.JapaneseCalendar.SolarTerm.html#isCenterPoint"><span class="hs-identifier hs-var">isCenterPoint</span></a><span>
</span><a name="line-7"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Data.Time.JapaneseCalendar.SolarTerm.html#solarTerm"><span class="hs-identifier hs-var">solarTerm</span></a><span>
</span><a name="line-8"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Data.Time.JapaneseCalendar.SolarTerm.html#nearestSolarTerm"><span class="hs-identifier hs-var">nearestSolarTerm</span></a><span>
</span><a name="line-9"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Data.Time.JapaneseCalendar.SolarTerm.html#solarTermsFrom"><span class="hs-identifier hs-var">solarTermsFrom</span></a><span>
</span><a name="line-10"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Data.Time.JapaneseCalendar.SolarTerm.html#findNearestSolarTerm"><span class="hs-identifier hs-var">findNearestSolarTerm</span></a><span>
</span><a name="line-11"></a><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-12"></a><span>
</span><a name="line-13"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Time</span><span class="hs-operator">.</span><span class="hs-identifier">Calendar</span><span>
</span><a name="line-14"></a><span class="hs-keyword">import</span><span> </span><a href="Data.Time.JapaneseCalendar.Internal.Sun.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Time</span><span class="hs-operator">.</span><span class="hs-identifier">JapaneseCalendar</span><span class="hs-operator">.</span><span class="hs-identifier">Internal</span><span class="hs-operator">.</span><span class="hs-identifier">Sun</span></a><span>
</span><a name="line-15"></a><span class="hs-keyword">import</span><span> </span><a href="Data.Time.JapaneseCalendar.Internal.DataUtils.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Time</span><span class="hs-operator">.</span><span class="hs-identifier">JapaneseCalendar</span><span class="hs-operator">.</span><span class="hs-identifier">Internal</span><span class="hs-operator">.</span><span class="hs-identifier">DataUtils</span></a><span>
</span><a name="line-16"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Time</span><span class="hs-operator">.</span><span class="hs-identifier">LocalTime</span><span>
</span><a name="line-17"></a><span>
</span><a name="line-18"></a><span class="hs-comment">-- | the twenty-four solar terms</span><span>
</span><a name="line-19"></a><span class="hs-keyword">data</span><span> </span><a name="SolarTerm"><a href="Data.Time.JapaneseCalendar.SolarTerm.html#SolarTerm"><span class="hs-identifier">SolarTerm</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-20"></a><span>    </span><a name="VernalEquinox"><a href="Data.Time.JapaneseCalendar.SolarTerm.html#VernalEquinox"><span class="hs-identifier">VernalEquinox</span></a></a><span>  </span><span class="hs-comment">-- ^ &#26149;&#20998;</span><span>
</span><a name="line-21"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="ClearAndBright"><a href="Data.Time.JapaneseCalendar.SolarTerm.html#ClearAndBright"><span class="hs-identifier">ClearAndBright</span></a></a><span>  </span><span class="hs-comment">-- ^ &#28165;&#26126;</span><span>
</span><a name="line-22"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="GrainRain"><a href="Data.Time.JapaneseCalendar.SolarTerm.html#GrainRain"><span class="hs-identifier">GrainRain</span></a></a><span>  </span><span class="hs-comment">-- ^ &#31296;&#38632;</span><span>
</span><a name="line-23"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="StartOfSummer"><a href="Data.Time.JapaneseCalendar.SolarTerm.html#StartOfSummer"><span class="hs-identifier">StartOfSummer</span></a></a><span>  </span><span class="hs-comment">-- ^ &#31435;&#22799;</span><span>
</span><a name="line-24"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="GrainFull"><a href="Data.Time.JapaneseCalendar.SolarTerm.html#GrainFull"><span class="hs-identifier">GrainFull</span></a></a><span>  </span><span class="hs-comment">-- ^ &#23567;&#28288;</span><span>
</span><a name="line-25"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="GrainInEar"><a href="Data.Time.JapaneseCalendar.SolarTerm.html#GrainInEar"><span class="hs-identifier">GrainInEar</span></a></a><span>  </span><span class="hs-comment">-- ^ &#33426;&#31278;</span><span>
</span><a name="line-26"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="SummerSolstice"><a href="Data.Time.JapaneseCalendar.SolarTerm.html#SummerSolstice"><span class="hs-identifier">SummerSolstice</span></a></a><span>  </span><span class="hs-comment">-- ^ &#22799;&#33267;</span><span>
</span><a name="line-27"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="MinorHeat"><a href="Data.Time.JapaneseCalendar.SolarTerm.html#MinorHeat"><span class="hs-identifier">MinorHeat</span></a></a><span>  </span><span class="hs-comment">-- ^ &#23567;&#26257;</span><span>
</span><a name="line-28"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="MajorHeat"><a href="Data.Time.JapaneseCalendar.SolarTerm.html#MajorHeat"><span class="hs-identifier">MajorHeat</span></a></a><span>  </span><span class="hs-comment">-- ^ &#22823;&#26257;</span><span>
</span><a name="line-29"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="StartOfAutumn"><a href="Data.Time.JapaneseCalendar.SolarTerm.html#StartOfAutumn"><span class="hs-identifier">StartOfAutumn</span></a></a><span>  </span><span class="hs-comment">-- ^ &#31435;&#31179;</span><span>
</span><a name="line-30"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="LimitOfHeat"><a href="Data.Time.JapaneseCalendar.SolarTerm.html#LimitOfHeat"><span class="hs-identifier">LimitOfHeat</span></a></a><span>  </span><span class="hs-comment">-- ^ &#20966;&#26257;</span><span>
</span><a name="line-31"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="WhiteDew"><a href="Data.Time.JapaneseCalendar.SolarTerm.html#WhiteDew"><span class="hs-identifier">WhiteDew</span></a></a><span>  </span><span class="hs-comment">-- ^ &#30333;&#38706;</span><span>
</span><a name="line-32"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="AutumnalEquinox"><a href="Data.Time.JapaneseCalendar.SolarTerm.html#AutumnalEquinox"><span class="hs-identifier">AutumnalEquinox</span></a></a><span>  </span><span class="hs-comment">-- ^ &#31179;&#20998;</span><span>
</span><a name="line-33"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="ColdDew"><a href="Data.Time.JapaneseCalendar.SolarTerm.html#ColdDew"><span class="hs-identifier">ColdDew</span></a></a><span>  </span><span class="hs-comment">-- ^ &#23506;&#38706;</span><span>
</span><a name="line-34"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="FrostDescent"><a href="Data.Time.JapaneseCalendar.SolarTerm.html#FrostDescent"><span class="hs-identifier">FrostDescent</span></a></a><span>  </span><span class="hs-comment">-- ^ &#38684;&#38477;</span><span>
</span><a name="line-35"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="StartOfWinter"><a href="Data.Time.JapaneseCalendar.SolarTerm.html#StartOfWinter"><span class="hs-identifier">StartOfWinter</span></a></a><span>  </span><span class="hs-comment">-- ^ &#31435;&#20908;</span><span>
</span><a name="line-36"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="MinorSnow"><a href="Data.Time.JapaneseCalendar.SolarTerm.html#MinorSnow"><span class="hs-identifier">MinorSnow</span></a></a><span>  </span><span class="hs-comment">-- ^ &#23567;&#38634;</span><span>
</span><a name="line-37"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="MajorSnow"><a href="Data.Time.JapaneseCalendar.SolarTerm.html#MajorSnow"><span class="hs-identifier">MajorSnow</span></a></a><span>  </span><span class="hs-comment">-- ^ &#22823;&#38634;</span><span>
</span><a name="line-38"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="WinterSolstice"><a href="Data.Time.JapaneseCalendar.SolarTerm.html#WinterSolstice"><span class="hs-identifier">WinterSolstice</span></a></a><span>  </span><span class="hs-comment">-- ^ &#20908;&#33267;</span><span>
</span><a name="line-39"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="MinorCold"><a href="Data.Time.JapaneseCalendar.SolarTerm.html#MinorCold"><span class="hs-identifier">MinorCold</span></a></a><span>  </span><span class="hs-comment">-- ^ &#23567;&#23506;</span><span>
</span><a name="line-40"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="MajorCold"><a href="Data.Time.JapaneseCalendar.SolarTerm.html#MajorCold"><span class="hs-identifier">MajorCold</span></a></a><span>  </span><span class="hs-comment">-- ^ &#22823;&#23506;</span><span>
</span><a name="line-41"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="StartOfSpring"><a href="Data.Time.JapaneseCalendar.SolarTerm.html#StartOfSpring"><span class="hs-identifier">StartOfSpring</span></a></a><span>  </span><span class="hs-comment">-- ^ &#31435;&#26149;</span><span>
</span><a name="line-42"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="RainWater"><a href="Data.Time.JapaneseCalendar.SolarTerm.html#RainWater"><span class="hs-identifier">RainWater</span></a></a><span>  </span><span class="hs-comment">-- ^ &#38632;&#27700;</span><span>
</span><a name="line-43"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="AwakeningOfInsects"><a href="Data.Time.JapaneseCalendar.SolarTerm.html#AwakeningOfInsects"><span class="hs-identifier">AwakeningOfInsects</span></a></a><span>  </span><span class="hs-comment">-- ^ &#21843;&#34756;</span><span>
</span><a name="line-44"></a><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Bounded</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Enum</span><span class="hs-special">)</span><span>
</span><a name="line-45"></a><span>
</span><a name="line-46"></a><span class="hs-identifier">japaneseNames</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">String</span><span class="hs-special">]</span><span>
</span><a name="line-47"></a><a name="japaneseNames"><a href="Data.Time.JapaneseCalendar.SolarTerm.html#japaneseNames"><span class="hs-identifier">japaneseNames</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-48"></a><span>  </span><span class="hs-special">[</span><span> </span><span class="hs-string">&quot;&#26149;&#20998;&quot;</span><span>
</span><a name="line-49"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;&#28165;&#26126;&quot;</span><span>
</span><a name="line-50"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;&#31296;&#38632;&quot;</span><span>
</span><a name="line-51"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;&#31435;&#22799;&quot;</span><span>
</span><a name="line-52"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;&#23567;&#28288;&quot;</span><span>
</span><a name="line-53"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;&#33426;&#31278;&quot;</span><span>
</span><a name="line-54"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;&#22799;&#33267;&quot;</span><span>
</span><a name="line-55"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;&#23567;&#26257;&quot;</span><span>
</span><a name="line-56"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;&#22823;&#26257;&quot;</span><span>
</span><a name="line-57"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;&#31435;&#31179;&quot;</span><span>
</span><a name="line-58"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;&#20966;&#26257;&quot;</span><span>
</span><a name="line-59"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;&#30333;&#38706;&quot;</span><span>
</span><a name="line-60"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;&#31179;&#20998;&quot;</span><span>
</span><a name="line-61"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;&#23506;&#38706;&quot;</span><span>
</span><a name="line-62"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;&#38684;&#38477;&quot;</span><span>
</span><a name="line-63"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;&#31435;&#20908;&quot;</span><span>
</span><a name="line-64"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;&#23567;&#38634;&quot;</span><span>
</span><a name="line-65"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;&#22823;&#38634;&quot;</span><span>
</span><a name="line-66"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;&#20908;&#33267;&quot;</span><span>
</span><a name="line-67"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;&#23567;&#23506;&quot;</span><span>
</span><a name="line-68"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;&#22823;&#23506;&quot;</span><span>
</span><a name="line-69"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;&#31435;&#26149;&quot;</span><span>
</span><a name="line-70"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;&#38632;&#27700;&quot;</span><span>
</span><a name="line-71"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;&#21843;&#34756;&quot;</span><span>
</span><a name="line-72"></a><span>  </span><span class="hs-special">]</span><span>
</span><a name="line-73"></a><span>
</span><a name="line-74"></a><span class="hs-comment">-- | returns a Japanese name of a solar term</span><span>
</span><a name="line-75"></a><span class="hs-identifier">solarTermToJapaneseName</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Time.JapaneseCalendar.SolarTerm.html#SolarTerm"><span class="hs-identifier hs-type">SolarTerm</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-76"></a><a name="solarTermToJapaneseName"><a href="Data.Time.JapaneseCalendar.SolarTerm.html#solarTermToJapaneseName"><span class="hs-identifier">solarTermToJapaneseName</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Time.JapaneseCalendar.Internal.DataUtils.html#enumToName"><span class="hs-identifier hs-var">enumToName</span></a><span> </span><a href="Data.Time.JapaneseCalendar.SolarTerm.html#japaneseNames"><span class="hs-identifier hs-var">japaneseNames</span></a><span>
</span><a name="line-77"></a><span>
</span><a name="line-78"></a><span class="hs-comment">-- | converts a Japanese name of a solar term into a SolarTerm</span><span>
</span><a name="line-79"></a><span class="hs-identifier">solarTermFromJapaneseName</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="Data.Time.JapaneseCalendar.SolarTerm.html#SolarTerm"><span class="hs-identifier hs-type">SolarTerm</span></a><span>
</span><a name="line-80"></a><a name="solarTermFromJapaneseName"><a href="Data.Time.JapaneseCalendar.SolarTerm.html#solarTermFromJapaneseName"><span class="hs-identifier">solarTermFromJapaneseName</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Time.JapaneseCalendar.Internal.DataUtils.html#enumFromName"><span class="hs-identifier hs-var">enumFromName</span></a><span> </span><a href="Data.Time.JapaneseCalendar.SolarTerm.html#japaneseNames"><span class="hs-identifier hs-var">japaneseNames</span></a><span>
</span><a name="line-81"></a><span>
</span><a name="line-82"></a><span class="hs-comment">-- | tests whether the solar term is a segment point, sekki</span><span>
</span><a name="line-83"></a><span class="hs-identifier">isSegmentPoint</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Time.JapaneseCalendar.SolarTerm.html#SolarTerm"><span class="hs-identifier hs-type">SolarTerm</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-84"></a><a name="isSegmentPoint"><a href="Data.Time.JapaneseCalendar.SolarTerm.html#isSegmentPoint"><span class="hs-identifier">isSegmentPoint</span></a></a><span> </span><a name="local-6989586621679030469"><a href="#local-6989586621679030469"><span class="hs-identifier">term</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromEnum</span><span> </span><a href="#local-6989586621679030469"><span class="hs-identifier hs-var">term</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">mod</span><span class="hs-special">`</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-85"></a><span>
</span><a name="line-86"></a><span class="hs-comment">-- | tests whether the solar term is a center point, chuki</span><span>
</span><a name="line-87"></a><span class="hs-identifier">isCenterPoint</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Time.JapaneseCalendar.SolarTerm.html#SolarTerm"><span class="hs-identifier hs-type">SolarTerm</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-88"></a><a name="isCenterPoint"><a href="Data.Time.JapaneseCalendar.SolarTerm.html#isCenterPoint"><span class="hs-identifier">isCenterPoint</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Data.Time.JapaneseCalendar.SolarTerm.html#isSegmentPoint"><span class="hs-identifier hs-var">isSegmentPoint</span></a><span>
</span><a name="line-89"></a><span>
</span><a name="line-90"></a><span class="hs-comment">-- | returns a solar term of a specified day</span><span>
</span><a name="line-91"></a><span class="hs-identifier">solarTerm</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">TimeZone</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Day</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="Data.Time.JapaneseCalendar.SolarTerm.html#SolarTerm"><span class="hs-identifier hs-type">SolarTerm</span></a><span>
</span><a name="line-92"></a><a name="solarTerm"><a href="Data.Time.JapaneseCalendar.SolarTerm.html#solarTerm"><span class="hs-identifier">solarTerm</span></a></a><span> </span><a name="local-6989586621679030470"><a href="#local-6989586621679030470"><span class="hs-identifier">zone</span></a></a><span> </span><a name="local-6989586621679030471"><a href="#local-6989586621679030471"><span class="hs-identifier">day</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679030471"><span class="hs-identifier hs-var">day</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679030473"><span class="hs-identifier hs-var">divisionDay</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679030472"><span class="hs-identifier hs-var">term</span></a><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-93"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-94"></a><span>    </span><span class="hs-special">(</span><a name="local-6989586621679030472"><a href="#local-6989586621679030472"><span class="hs-identifier">term</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679030473"><a href="#local-6989586621679030473"><span class="hs-identifier">divisionDay</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Time.JapaneseCalendar.SolarTerm.html#nearestSolarTerm"><span class="hs-identifier hs-var">nearestSolarTerm</span></a><span> </span><a href="#local-6989586621679030470"><span class="hs-identifier hs-var">zone</span></a><span> </span><a href="#local-6989586621679030471"><span class="hs-identifier hs-var">day</span></a><span>
</span><a name="line-95"></a><span>
</span><a name="line-96"></a><span class="hs-comment">-- | finds the nearest solar term</span><span>
</span><a name="line-97"></a><span class="hs-identifier">nearestSolarTerm</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">TimeZone</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Day</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Data.Time.JapaneseCalendar.SolarTerm.html#SolarTerm"><span class="hs-identifier hs-type">SolarTerm</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Day</span><span class="hs-special">)</span><span>
</span><a name="line-98"></a><a name="nearestSolarTerm"><a href="Data.Time.JapaneseCalendar.SolarTerm.html#nearestSolarTerm"><span class="hs-identifier">nearestSolarTerm</span></a></a><span> </span><a name="local-6989586621679030474"><a href="#local-6989586621679030474"><span class="hs-identifier">zone</span></a></a><span> </span><a name="local-6989586621679030475"><a href="#local-6989586621679030475"><span class="hs-identifier">day</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Time.JapaneseCalendar.SolarTerm.html#fromIndex"><span class="hs-identifier hs-var">fromIndex</span></a><span> </span><a href="#local-6989586621679030474"><span class="hs-identifier hs-var">zone</span></a><span> </span><a href="#local-6989586621679030477"><span class="hs-identifier hs-var">index</span></a><span> </span><a href="#local-6989586621679030475"><span class="hs-identifier hs-var">day</span></a><span>
</span><a name="line-99"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-100"></a><span>    </span><a name="local-6989586621679030476"><a href="#local-6989586621679030476"><span class="hs-identifier">utcTime</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">localTimeToUTC</span><span> </span><a href="#local-6989586621679030474"><span class="hs-identifier hs-var">zone</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">LocalTime</span><span> </span><a href="#local-6989586621679030475"><span class="hs-identifier hs-var">day</span></a><span> </span><span class="hs-identifier hs-var">midday</span><span class="hs-special">)</span><span>
</span><a name="line-101"></a><span>    </span><a name="local-6989586621679030477"><a href="#local-6989586621679030477"><span class="hs-identifier">index</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">round</span><span> </span><span class="hs-special">(</span><a href="Data.Time.JapaneseCalendar.Internal.Sun.html#sunEclipticLongitude"><span class="hs-identifier hs-var">sunEclipticLongitude</span></a><span> </span><a href="#local-6989586621679030476"><span class="hs-identifier hs-var">utcTime</span></a><span> </span><span class="hs-operator hs-var">/</span><span> </span><span class="hs-number">15</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">mod</span><span class="hs-special">`</span><span> </span><span class="hs-number">24</span><span>
</span><a name="line-102"></a><span>
</span><a name="line-103"></a><span class="hs-comment">-- | creates a list of solar terms starting with the nearest solar term from a specified day</span><span>
</span><a name="line-104"></a><span class="hs-identifier">solarTermsFrom</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">TimeZone</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Day</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="Data.Time.JapaneseCalendar.SolarTerm.html#SolarTerm"><span class="hs-identifier hs-type">SolarTerm</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Day</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-105"></a><a name="solarTermsFrom"><a href="Data.Time.JapaneseCalendar.SolarTerm.html#solarTermsFrom"><span class="hs-identifier">solarTermsFrom</span></a></a><span> </span><a name="local-6989586621679030680"><a href="#local-6989586621679030680"><span class="hs-identifier">zone</span></a></a><span> </span><a name="local-6989586621679030681"><a href="#local-6989586621679030681"><span class="hs-identifier">day</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679030682"><span class="hs-identifier hs-var">firstElem</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="Data.Time.JapaneseCalendar.SolarTerm.html#solarTermsFrom"><span class="hs-identifier hs-var">solarTermsFrom</span></a><span> </span><a href="#local-6989586621679030680"><span class="hs-identifier hs-var">zone</span></a><span> </span><a href="#local-6989586621679030684"><span class="hs-identifier hs-var">nextSeed</span></a><span>
</span><a name="line-106"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-107"></a><span>    </span><a name="local-6989586621679030682"><a href="#local-6989586621679030682"><span class="hs-identifier">firstElem</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679030683"><a href="#local-6989586621679030683"><span class="hs-identifier">firstElemDay</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Time.JapaneseCalendar.SolarTerm.html#nearestSolarTerm"><span class="hs-identifier hs-var">nearestSolarTerm</span></a><span> </span><a href="#local-6989586621679030680"><span class="hs-identifier hs-var">zone</span></a><span> </span><a href="#local-6989586621679030681"><span class="hs-identifier hs-var">day</span></a><span>
</span><a name="line-108"></a><span>    </span><a name="local-6989586621679030684"><a href="#local-6989586621679030684"><span class="hs-identifier">nextSeed</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">addDays</span><span> </span><span class="hs-number">15</span><span> </span><a href="#local-6989586621679030683"><span class="hs-identifier hs-var">firstElemDay</span></a><span>
</span><a name="line-109"></a><span>
</span><a name="line-110"></a><span class="hs-comment">-- | finds the nearest specified solar term</span><span>
</span><a name="line-111"></a><span class="hs-identifier">findNearestSolarTerm</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">TimeZone</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Time.JapaneseCalendar.SolarTerm.html#SolarTerm"><span class="hs-identifier hs-type">SolarTerm</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Day</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Day</span><span>
</span><a name="line-112"></a><a name="findNearestSolarTerm"><a href="Data.Time.JapaneseCalendar.SolarTerm.html#findNearestSolarTerm"><span class="hs-identifier">findNearestSolarTerm</span></a></a><span> </span><a name="local-6989586621679030685"><a href="#local-6989586621679030685"><span class="hs-identifier">zone</span></a></a><span> </span><a name="local-6989586621679030686"><a href="#local-6989586621679030686"><span class="hs-identifier">term</span></a></a><span> </span><a name="local-6989586621679030687"><a href="#local-6989586621679030687"><span class="hs-identifier">day</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Data.Time.JapaneseCalendar.SolarTerm.html#fromIndex"><span class="hs-identifier hs-var">fromIndex</span></a><span> </span><a href="#local-6989586621679030685"><span class="hs-identifier hs-var">zone</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromEnum</span><span> </span><a href="#local-6989586621679030686"><span class="hs-identifier hs-var">term</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679030687"><span class="hs-identifier hs-var">day</span></a><span>
</span><a name="line-113"></a><span>
</span><a name="line-114"></a><span class="hs-identifier">fromIndex</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">TimeZone</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Day</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Data.Time.JapaneseCalendar.SolarTerm.html#SolarTerm"><span class="hs-identifier hs-type">SolarTerm</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Day</span><span class="hs-special">)</span><span>
</span><a name="line-115"></a><a name="fromIndex"><a href="Data.Time.JapaneseCalendar.SolarTerm.html#fromIndex"><span class="hs-identifier">fromIndex</span></a></a><span> </span><a name="local-6989586621679030699"><a href="#local-6989586621679030699"><span class="hs-identifier">zone</span></a></a><span> </span><a name="local-6989586621679030700"><a href="#local-6989586621679030700"><span class="hs-identifier">index</span></a></a><span> </span><a name="local-6989586621679030701"><a href="#local-6989586621679030701"><span class="hs-identifier">day</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">toEnum</span><span> </span><a href="#local-6989586621679030700"><span class="hs-identifier hs-var">index</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679030705"><span class="hs-identifier hs-var">divisionDay</span></a><span class="hs-special">)</span><span>
</span><a name="line-116"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-117"></a><span>    </span><a name="local-6989586621679030702"><a href="#local-6989586621679030702"><span class="hs-identifier">utcTime</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">localTimeToUTC</span><span> </span><a href="#local-6989586621679030699"><span class="hs-identifier hs-var">zone</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">LocalTime</span><span> </span><a href="#local-6989586621679030701"><span class="hs-identifier hs-var">day</span></a><span> </span><span class="hs-identifier hs-var">midday</span><span class="hs-special">)</span><span>
</span><a name="line-118"></a><span>    </span><a name="local-6989586621679030703"><a href="#local-6989586621679030703"><span class="hs-identifier">divisionUTCTime</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Time.JapaneseCalendar.Internal.Sun.html#sunEclipticLongitudeToTime"><span class="hs-identifier hs-var">sunEclipticLongitudeToTime</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679030700"><span class="hs-identifier hs-var">index</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-number">15</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679030702"><span class="hs-identifier hs-var">utcTime</span></a><span>
</span><a name="line-119"></a><span>    </span><a name="local-6989586621679030704"><a href="#local-6989586621679030704"><span class="hs-identifier">divisionTime</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">utcToZonedTime</span><span> </span><a href="#local-6989586621679030699"><span class="hs-identifier hs-var">zone</span></a><span> </span><a href="#local-6989586621679030703"><span class="hs-identifier hs-var">divisionUTCTime</span></a><span>
</span><a name="line-120"></a><span>    </span><a name="local-6989586621679030705"><a href="#local-6989586621679030705"><span class="hs-identifier">divisionDay</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">localDay</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">zonedTimeToLocalTime</span><span> </span><a href="#local-6989586621679030704"><span class="hs-identifier hs-var">divisionTime</span></a><span>
</span><a name="line-121"></a></pre></body></html>