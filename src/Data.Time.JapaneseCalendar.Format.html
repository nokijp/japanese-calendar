<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE TemplateHaskell, QuasiQuotes #-}</span><span>
</span><a name="line-2"></a><span>
</span><a name="line-3"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data.Time.JapaneseCalendar.Format</span><span>
</span><a name="line-4"></a><span>  </span><span class="hs-special">(</span><span> </span><a href="Data.Time.JapaneseCalendar.Format.html#formatTempoDate"><span class="hs-identifier hs-var">formatTempoDate</span></a><span>
</span><a name="line-5"></a><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-6"></a><span>
</span><a name="line-7"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Arrow</span><span>
</span><a name="line-8"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Foldable</span><span>
</span><a name="line-9"></a><span class="hs-keyword">import</span><span> </span><a href="Data.Time.JapaneseCalendar.JapaneseName.html"><span class="hs-identifier">Data.Time.JapaneseCalendar.JapaneseName</span></a><span>
</span><a name="line-10"></a><span class="hs-keyword">import</span><span> </span><a href="Data.Time.JapaneseCalendar.TempoCalendar.html"><span class="hs-identifier">Data.Time.JapaneseCalendar.TempoCalendar</span></a><span>
</span><a name="line-11"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Language.Haskell.TH</span><span>
</span><a name="line-12"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Language.Haskell.TH.Quote</span><span>
</span><a name="line-13"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Text.Parsec</span><span>
</span><a name="line-14"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Text.Parsec.String</span><span>
</span><a name="line-15"></a><span>
</span><a name="line-16"></a><span class="hs-comment">-- | a format tool for 'TempoDate' using Template Haskell</span><span>
</span><a name="line-17"></a><span class="hs-comment">--</span><span>
</span><a name="line-18"></a><span class="hs-comment">-- @[formatTempoDate|%y&#24180;%M&#26376;%d&#26085;|]@ generates a function converting a 'TempoDate' into a 'String' like @&quot;2000&#24180;1&#26376;2&#26085;&quot;@</span><span>
</span><a name="line-19"></a><span class="hs-comment">--</span><span>
</span><a name="line-20"></a><span class="hs-comment">-- [@%y@] year (e.g. @&quot;2000&quot;@)</span><span>
</span><a name="line-21"></a><span class="hs-comment">--</span><span>
</span><a name="line-22"></a><span class="hs-comment">-- [@%L@] leap month sign, @&quot;&quot;@ or @&quot;&#38287;&quot;@</span><span>
</span><a name="line-23"></a><span class="hs-comment">--</span><span>
</span><a name="line-24"></a><span class="hs-comment">-- [@%m@] month, @&quot;1&quot;@ - @&quot;12&quot;@</span><span>
</span><a name="line-25"></a><span class="hs-comment">--</span><span>
</span><a name="line-26"></a><span class="hs-comment">-- [@%M@] same as @%L%m@ (e.g. @&quot;&#38287;10&quot;@)</span><span>
</span><a name="line-27"></a><span class="hs-comment">--</span><span>
</span><a name="line-28"></a><span class="hs-comment">-- [@%b@] month in Japanese (e.g. @&quot;&#31070;&#28961;&#26376;&quot;@)</span><span>
</span><a name="line-29"></a><span class="hs-comment">--</span><span>
</span><a name="line-30"></a><span class="hs-comment">-- [@%B@] same as @%L%b@ (e.g. @&quot;&#38287;&#31070;&#28961;&#26376;&quot;@)</span><span>
</span><a name="line-31"></a><span class="hs-comment">--</span><span>
</span><a name="line-32"></a><span class="hs-comment">-- [@%d@] day, @&quot;1&quot;@ - @&quot;31&quot;@</span><span>
</span><a name="line-33"></a><span class="hs-comment">--</span><span>
</span><a name="line-34"></a><span class="hs-comment">-- padding qualifiers like printf in C are also available</span><span>
</span><a name="line-35"></a><span class="hs-comment">--</span><span>
</span><a name="line-36"></a><span class="hs-comment">-- [@%2m@] pad with two spaces</span><span>
</span><a name="line-37"></a><span class="hs-comment">--</span><span>
</span><a name="line-38"></a><span class="hs-comment">-- [@%02m@] pad with two zeros</span><span>
</span><a name="line-39"></a><span class="hs-identifier">formatTempoDate</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">QuasiQuoter</span><span>
</span><a name="line-40"></a><a name="formatTempoDate"><a href="Data.Time.JapaneseCalendar.Format.html#formatTempoDate"><span class="hs-identifier">formatTempoDate</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">QuasiQuoter</span><span>
</span><a name="line-41"></a><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">quoteExp</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Time.JapaneseCalendar.Format.html#quoteFormatExp"><span class="hs-identifier hs-var">quoteFormatExp</span></a><span>
</span><a name="line-42"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">quotePat</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">undefined</span><span>
</span><a name="line-43"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">quoteType</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">undefined</span><span>
</span><a name="line-44"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">quoteDec</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">undefined</span><span>
</span><a name="line-45"></a><span>  </span><span class="hs-special">}</span><span>
</span><a name="line-46"></a><span>
</span><a name="line-47"></a><span class="hs-keyword">data</span><span> </span><a name="Component"><a href="Data.Time.JapaneseCalendar.Format.html#Component"><span class="hs-identifier">Component</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-48"></a><span>    </span><a name="StringComponent"><a href="Data.Time.JapaneseCalendar.Format.html#StringComponent"><span class="hs-identifier">StringComponent</span></a></a><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-49"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="FormatComponent"><a href="Data.Time.JapaneseCalendar.Format.html#FormatComponent"><span class="hs-identifier">FormatComponent</span></a></a><span> </span><a href="Data.Time.JapaneseCalendar.Format.html#ComponentType"><span class="hs-identifier hs-type">ComponentType</span></a><span>
</span><a name="line-50"></a><span>
</span><a name="line-51"></a><span class="hs-keyword">data</span><span> </span><a name="ComponentType"><a href="Data.Time.JapaneseCalendar.Format.html#ComponentType"><span class="hs-identifier">ComponentType</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-52"></a><span>    </span><a name="YearNum"><a href="Data.Time.JapaneseCalendar.Format.html#YearNum"><span class="hs-identifier">YearNum</span></a></a><span> </span><a href="Data.Time.JapaneseCalendar.Format.html#PadType"><span class="hs-identifier hs-type">PadType</span></a><span>  </span><span class="hs-comment">-- %y &quot;2000&quot;</span><span>
</span><a name="line-53"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="LeapMonthName"><a href="Data.Time.JapaneseCalendar.Format.html#LeapMonthName"><span class="hs-identifier">LeapMonthName</span></a></a><span>  </span><span class="hs-comment">-- %L &quot;&quot; or &quot;&#38287;&quot;</span><span>
</span><a name="line-54"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="MonthNum"><a href="Data.Time.JapaneseCalendar.Format.html#MonthNum"><span class="hs-identifier">MonthNum</span></a></a><span> </span><a href="Data.Time.JapaneseCalendar.Format.html#PadType"><span class="hs-identifier hs-type">PadType</span></a><span>  </span><span class="hs-comment">-- %m &quot;1&quot; - &quot;12&quot;</span><span>
</span><a name="line-55"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="MonthFullNum"><a href="Data.Time.JapaneseCalendar.Format.html#MonthFullNum"><span class="hs-identifier">MonthFullNum</span></a></a><span> </span><a href="Data.Time.JapaneseCalendar.Format.html#PadType"><span class="hs-identifier hs-type">PadType</span></a><span>  </span><span class="hs-comment">-- %M &quot;&#38287;10&quot;</span><span>
</span><a name="line-56"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="MonthName"><a href="Data.Time.JapaneseCalendar.Format.html#MonthName"><span class="hs-identifier">MonthName</span></a></a><span>  </span><span class="hs-comment">-- %b &quot;&#31070;&#28961;&#26376;&quot;</span><span>
</span><a name="line-57"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="MonthFullName"><a href="Data.Time.JapaneseCalendar.Format.html#MonthFullName"><span class="hs-identifier">MonthFullName</span></a></a><span>  </span><span class="hs-comment">-- %B &quot;&#38287;&#31070;&#28961;&#26376;&quot;</span><span>
</span><a name="line-58"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="DayNum"><a href="Data.Time.JapaneseCalendar.Format.html#DayNum"><span class="hs-identifier">DayNum</span></a></a><span> </span><a href="Data.Time.JapaneseCalendar.Format.html#PadType"><span class="hs-identifier hs-type">PadType</span></a><span>  </span><span class="hs-comment">-- %d &quot;1&quot; - &quot;31&quot;</span><span>
</span><a name="line-59"></a><span>
</span><a name="line-60"></a><span class="hs-keyword">data</span><span> </span><a name="PadType"><a href="Data.Time.JapaneseCalendar.Format.html#PadType"><span class="hs-identifier">PadType</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-61"></a><span>    </span><a name="NonePad"><a href="Data.Time.JapaneseCalendar.Format.html#NonePad"><span class="hs-identifier">NonePad</span></a></a><span>
</span><a name="line-62"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="SpacePad"><a href="Data.Time.JapaneseCalendar.Format.html#SpacePad"><span class="hs-identifier">SpacePad</span></a></a><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-63"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="ZeroPad"><a href="Data.Time.JapaneseCalendar.Format.html#ZeroPad"><span class="hs-identifier">ZeroPad</span></a></a><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-64"></a><span>
</span><a name="line-65"></a><span class="hs-identifier">quoteFormatExp</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ExpQ</span><span>
</span><a name="line-66"></a><a name="quoteFormatExp"><a href="Data.Time.JapaneseCalendar.Format.html#quoteFormatExp"><span class="hs-identifier">quoteFormatExp</span></a></a><span> </span><a name="local-6989586621679110246"><a href="#local-6989586621679110246"><span class="hs-identifier">str</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-67"></a><span>  </span><a name="local-6989586621679110247"><a href="#local-6989586621679110247"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newName</span><span> </span><span class="hs-string">&quot;_x&quot;</span><span>
</span><a name="line-68"></a><span>  </span><a name="local-6989586621679110248"><a href="#local-6989586621679110248"><span class="hs-identifier">components</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">either</span><span> </span><span class="hs-identifier hs-var">fail</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Data.Time.JapaneseCalendar.Format.html#parseFormat"><span class="hs-identifier hs-var">parseFormat</span></a><span> </span><a href="#local-6989586621679110246"><span class="hs-identifier hs-var">str</span></a><span>
</span><a name="line-69"></a><span>  </span><a name="local-6989586621679110249"><a href="#local-6989586621679110249"><span class="hs-identifier">exps</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><span class="hs-special">(</span><a href="Data.Time.JapaneseCalendar.Format.html#formatExp"><span class="hs-identifier hs-var">formatExp</span></a><span> </span><a href="#local-6989586621679110247"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679110248"><span class="hs-identifier hs-var">components</span></a><span>
</span><a name="line-70"></a><span>  </span><span class="hs-identifier hs-var">lamE</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">varP</span><span> </span><a href="#local-6989586621679110247"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">foldlM</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679110250"><a href="#local-6989586621679110250"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679110251"><a href="#local-6989586621679110251"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[|</span><span class="hs-special">$(</span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679110250"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">$(</span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679110251"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span class="hs-special">|]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">LitE</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">StringL</span><span> </span><span class="hs-string">&quot;&quot;</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679110249"><span class="hs-identifier hs-var">exps</span></a><span>
</span><a name="line-71"></a><span>
</span><a name="line-72"></a><span class="hs-identifier">formatExp</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Time.JapaneseCalendar.Format.html#Component"><span class="hs-identifier hs-type">Component</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ExpQ</span><span>
</span><a name="line-73"></a><a name="formatExp"><a href="Data.Time.JapaneseCalendar.Format.html#formatExp"><span class="hs-identifier">formatExp</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="Data.Time.JapaneseCalendar.Format.html#StringComponent"><span class="hs-identifier hs-var">StringComponent</span></a><span> </span><a name="local-6989586621679110254"><a href="#local-6989586621679110254"><span class="hs-identifier">s</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">litE</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">StringL</span><span> </span><a href="#local-6989586621679110254"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-74"></a><span class="hs-identifier">formatExp</span><span> </span><a name="local-6989586621679110255"><a href="#local-6989586621679110255"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Time.JapaneseCalendar.Format.html#FormatComponent"><span class="hs-identifier hs-var">FormatComponent</span></a><span> </span><span class="hs-special">(</span><a href="Data.Time.JapaneseCalendar.Format.html#YearNum"><span class="hs-identifier hs-var">YearNum</span></a><span> </span><a name="local-6989586621679110256"><a href="#local-6989586621679110256"><span class="hs-identifier">pt</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[|</span><span class="hs-special">$(</span><a href="Data.Time.JapaneseCalendar.Format.html#padFunc"><span class="hs-identifier hs-var">padFunc</span></a><span> </span><a href="#local-6989586621679110256"><span class="hs-identifier hs-var">pt</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">tempoYear</span><span> </span><span class="hs-special">$(</span><span class="hs-identifier hs-var">varE</span><span> </span><a href="#local-6989586621679110255"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">|]</span><span>
</span><a name="line-75"></a><span class="hs-identifier">formatExp</span><span> </span><a name="local-6989586621679110259"><a href="#local-6989586621679110259"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Time.JapaneseCalendar.Format.html#FormatComponent"><span class="hs-identifier hs-var">FormatComponent</span></a><span> </span><a href="Data.Time.JapaneseCalendar.Format.html#LeapMonthName"><span class="hs-identifier hs-var">LeapMonthName</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[|</span><a href="Data.Time.JapaneseCalendar.Format.html#leapMonthSign"><span class="hs-identifier hs-var">leapMonthSign</span></a><span> </span><span class="hs-special">$(</span><span class="hs-identifier hs-var">varE</span><span> </span><a href="#local-6989586621679110259"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">|]</span><span>
</span><a name="line-76"></a><span class="hs-identifier">formatExp</span><span> </span><a name="local-6989586621679110261"><a href="#local-6989586621679110261"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Time.JapaneseCalendar.Format.html#FormatComponent"><span class="hs-identifier hs-var">FormatComponent</span></a><span> </span><span class="hs-special">(</span><a href="Data.Time.JapaneseCalendar.Format.html#MonthNum"><span class="hs-identifier hs-var">MonthNum</span></a><span> </span><a name="local-6989586621679110262"><a href="#local-6989586621679110262"><span class="hs-identifier">pt</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[|</span><span class="hs-special">$(</span><a href="Data.Time.JapaneseCalendar.Format.html#padFunc"><span class="hs-identifier hs-var">padFunc</span></a><span> </span><a href="#local-6989586621679110262"><span class="hs-identifier hs-var">pt</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Data.Time.JapaneseCalendar.TempoCalendar.html#monthNumber"><span class="hs-identifier hs-var">monthNumber</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">tempoMonth</span><span> </span><span class="hs-special">$(</span><span class="hs-identifier hs-var">varE</span><span> </span><a href="#local-6989586621679110261"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">|]</span><span>
</span><a name="line-77"></a><span class="hs-identifier">formatExp</span><span> </span><a name="local-6989586621679110265"><a href="#local-6989586621679110265"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Time.JapaneseCalendar.Format.html#FormatComponent"><span class="hs-identifier hs-var">FormatComponent</span></a><span> </span><span class="hs-special">(</span><a href="Data.Time.JapaneseCalendar.Format.html#MonthFullNum"><span class="hs-identifier hs-var">MonthFullNum</span></a><span> </span><a name="local-6989586621679110266"><a href="#local-6989586621679110266"><span class="hs-identifier">pt</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[|</span><span class="hs-special">$(</span><a href="Data.Time.JapaneseCalendar.Format.html#formatExp"><span class="hs-identifier hs-var">formatExp</span></a><span> </span><a href="#local-6989586621679110265"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Data.Time.JapaneseCalendar.Format.html#FormatComponent"><span class="hs-identifier hs-var">FormatComponent</span></a><span> </span><a href="Data.Time.JapaneseCalendar.Format.html#LeapMonthName"><span class="hs-identifier hs-var">LeapMonthName</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">$(</span><a href="Data.Time.JapaneseCalendar.Format.html#formatExp"><span class="hs-identifier hs-var">formatExp</span></a><span> </span><a href="#local-6989586621679110265"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Data.Time.JapaneseCalendar.Format.html#FormatComponent"><span class="hs-identifier hs-var">FormatComponent</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Data.Time.JapaneseCalendar.Format.html#MonthNum"><span class="hs-identifier hs-var">MonthNum</span></a><span> </span><a href="#local-6989586621679110266"><span class="hs-identifier hs-var">pt</span></a><span class="hs-special">)</span><span class="hs-special">|]</span><span>
</span><a name="line-78"></a><span class="hs-identifier">formatExp</span><span> </span><a name="local-6989586621679110269"><a href="#local-6989586621679110269"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Time.JapaneseCalendar.Format.html#FormatComponent"><span class="hs-identifier hs-var">FormatComponent</span></a><span> </span><a href="Data.Time.JapaneseCalendar.Format.html#MonthName"><span class="hs-identifier hs-var">MonthName</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[|</span><a href="Data.Time.JapaneseCalendar.JapaneseName.html#toJapaneseName"><span class="hs-identifier hs-var">toJapaneseName</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">tempoMonthType</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">tempoMonth</span><span> </span><span class="hs-special">$(</span><span class="hs-identifier hs-var">varE</span><span> </span><a href="#local-6989586621679110269"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">|]</span><span>
</span><a name="line-79"></a><span class="hs-identifier">formatExp</span><span> </span><a name="local-6989586621679110271"><a href="#local-6989586621679110271"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Time.JapaneseCalendar.Format.html#FormatComponent"><span class="hs-identifier hs-var">FormatComponent</span></a><span> </span><a href="Data.Time.JapaneseCalendar.Format.html#MonthFullName"><span class="hs-identifier hs-var">MonthFullName</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[|</span><span class="hs-special">$(</span><a href="Data.Time.JapaneseCalendar.Format.html#formatExp"><span class="hs-identifier hs-var">formatExp</span></a><span> </span><a href="#local-6989586621679110271"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Data.Time.JapaneseCalendar.Format.html#FormatComponent"><span class="hs-identifier hs-var">FormatComponent</span></a><span> </span><a href="Data.Time.JapaneseCalendar.Format.html#LeapMonthName"><span class="hs-identifier hs-var">LeapMonthName</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">$(</span><a href="Data.Time.JapaneseCalendar.Format.html#formatExp"><span class="hs-identifier hs-var">formatExp</span></a><span> </span><a href="#local-6989586621679110271"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Data.Time.JapaneseCalendar.Format.html#FormatComponent"><span class="hs-identifier hs-var">FormatComponent</span></a><span> </span><a href="Data.Time.JapaneseCalendar.Format.html#MonthName"><span class="hs-identifier hs-var">MonthName</span></a><span class="hs-special">)</span><span class="hs-special">|]</span><span>
</span><a name="line-80"></a><span class="hs-identifier">formatExp</span><span> </span><a name="local-6989586621679110274"><a href="#local-6989586621679110274"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.Time.JapaneseCalendar.Format.html#FormatComponent"><span class="hs-identifier hs-var">FormatComponent</span></a><span> </span><span class="hs-special">(</span><a href="Data.Time.JapaneseCalendar.Format.html#DayNum"><span class="hs-identifier hs-var">DayNum</span></a><span> </span><a name="local-6989586621679110275"><a href="#local-6989586621679110275"><span class="hs-identifier">pt</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[|</span><span class="hs-special">$(</span><a href="Data.Time.JapaneseCalendar.Format.html#padFunc"><span class="hs-identifier hs-var">padFunc</span></a><span> </span><a href="#local-6989586621679110275"><span class="hs-identifier hs-var">pt</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">tempoDay</span><span> </span><span class="hs-special">$(</span><span class="hs-identifier hs-var">varE</span><span> </span><a href="#local-6989586621679110274"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">|]</span><span>
</span><a name="line-81"></a><span>
</span><a name="line-82"></a><span class="hs-identifier">padFunc</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Time.JapaneseCalendar.Format.html#PadType"><span class="hs-identifier hs-type">PadType</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ExpQ</span><span>
</span><a name="line-83"></a><a name="padFunc"><a href="Data.Time.JapaneseCalendar.Format.html#padFunc"><span class="hs-identifier">padFunc</span></a></a><span> </span><a href="Data.Time.JapaneseCalendar.Format.html#NonePad"><span class="hs-identifier hs-var">NonePad</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[|</span><span class="hs-identifier hs-var">id</span><span class="hs-special">|]</span><span>
</span><a name="line-84"></a><span class="hs-identifier">padFunc</span><span> </span><span class="hs-special">(</span><a href="Data.Time.JapaneseCalendar.Format.html#SpacePad"><span class="hs-identifier hs-var">SpacePad</span></a><span> </span><a name="local-6989586621679110278"><a href="#local-6989586621679110278"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[|</span><a href="Data.Time.JapaneseCalendar.Format.html#pad"><span class="hs-identifier hs-var">pad</span></a><span> </span><span class="hs-char">' '</span><span> </span><span class="hs-special">$(</span><span class="hs-identifier hs-var">litE</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">IntegerL</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">toInteger</span><span> </span><a href="#local-6989586621679110278"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span class="hs-special">|]</span><span>
</span><a name="line-85"></a><span class="hs-identifier">padFunc</span><span> </span><span class="hs-special">(</span><a href="Data.Time.JapaneseCalendar.Format.html#ZeroPad"><span class="hs-identifier hs-var">ZeroPad</span></a><span> </span><a name="local-6989586621679110280"><a href="#local-6989586621679110280"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[|</span><a href="Data.Time.JapaneseCalendar.Format.html#pad"><span class="hs-identifier hs-var">pad</span></a><span> </span><span class="hs-char">'0'</span><span> </span><span class="hs-special">$(</span><span class="hs-identifier hs-var">litE</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">IntegerL</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">toInteger</span><span> </span><a href="#local-6989586621679110280"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span class="hs-special">|]</span><span>
</span><a name="line-86"></a><span>
</span><a name="line-87"></a><span class="hs-identifier">pad</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Char</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-88"></a><a name="pad"><a href="Data.Time.JapaneseCalendar.Format.html#pad"><span class="hs-identifier">pad</span></a></a><span> </span><a name="local-6989586621679110282"><a href="#local-6989586621679110282"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679110283"><a href="#local-6989586621679110283"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679110284"><a href="#local-6989586621679110284"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679110285"><a href="#local-6989586621679110285"><span class="hs-identifier">padLength</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679110283"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679110284"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679110285"><span class="hs-identifier hs-var">padLength</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">replicate</span><span> </span><a href="#local-6989586621679110285"><span class="hs-identifier hs-var">padLength</span></a><span> </span><a href="#local-6989586621679110282"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679110284"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-keyword">else</span><span> </span><a href="#local-6989586621679110284"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-89"></a><span>
</span><a name="line-90"></a><span class="hs-identifier">leapMonthSign</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Time.JapaneseCalendar.TempoCalendar.html#TempoDate"><span class="hs-identifier hs-type">TempoDate</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-91"></a><a name="leapMonthSign"><a href="Data.Time.JapaneseCalendar.Format.html#leapMonthSign"><span class="hs-identifier">leapMonthSign</span></a></a><span> </span><a name="local-6989586621679110286"><a href="#local-6989586621679110286"><span class="hs-identifier">td</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="Data.Time.JapaneseCalendar.TempoCalendar.html#isLeapMonth"><span class="hs-identifier hs-var">isLeapMonth</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">tempoMonth</span><span> </span><a href="#local-6989586621679110286"><span class="hs-identifier hs-var">td</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-string">&quot;&#38287;&quot;</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-string">&quot;&quot;</span><span>
</span><a name="line-92"></a><span>
</span><a name="line-93"></a><span class="hs-identifier">parseFormat</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-special">[</span><a href="Data.Time.JapaneseCalendar.Format.html#Component"><span class="hs-identifier hs-type">Component</span></a><span class="hs-special">]</span><span>
</span><a name="line-94"></a><a name="parseFormat"><a href="Data.Time.JapaneseCalendar.Format.html#parseFormat"><span class="hs-identifier">parseFormat</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">left</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">parse</span><span> </span><a href="Data.Time.JapaneseCalendar.Format.html#parser"><span class="hs-identifier hs-var">parser</span></a><span> </span><span class="hs-string">&quot;&quot;</span><span>
</span><a name="line-95"></a><span>
</span><a name="line-96"></a><span class="hs-identifier">parser</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Parser</span><span> </span><span class="hs-special">[</span><a href="Data.Time.JapaneseCalendar.Format.html#Component"><span class="hs-identifier hs-type">Component</span></a><span class="hs-special">]</span><span>
</span><a name="line-97"></a><a name="parser"><a href="Data.Time.JapaneseCalendar.Format.html#parser"><span class="hs-identifier">parser</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">many</span><span> </span><span class="hs-special">(</span><a href="Data.Time.JapaneseCalendar.Format.html#stringComponentParser"><span class="hs-identifier hs-var">stringComponentParser</span></a><span> </span><span class="hs-operator hs-var">&lt;|&gt;</span><span> </span><a href="Data.Time.JapaneseCalendar.Format.html#formatComponentParser"><span class="hs-identifier hs-var">formatComponentParser</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;*</span><span> </span><span class="hs-identifier hs-var">eof</span><span>
</span><a name="line-98"></a><span>
</span><a name="line-99"></a><span class="hs-identifier">stringComponentParser</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Parser</span><span> </span><a href="Data.Time.JapaneseCalendar.Format.html#Component"><span class="hs-identifier hs-type">Component</span></a><span>
</span><a name="line-100"></a><a name="stringComponentParser"><a href="Data.Time.JapaneseCalendar.Format.html#stringComponentParser"><span class="hs-identifier">stringComponentParser</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Time.JapaneseCalendar.Format.html#StringComponent"><span class="hs-identifier hs-var">StringComponent</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">many1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">satisfy</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">/=</span><span> </span><span class="hs-char">'%'</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-101"></a><span>
</span><a name="line-102"></a><span class="hs-identifier">formatComponentParser</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Parser</span><span> </span><a href="Data.Time.JapaneseCalendar.Format.html#Component"><span class="hs-identifier hs-type">Component</span></a><span>
</span><a name="line-103"></a><a name="formatComponentParser"><a href="Data.Time.JapaneseCalendar.Format.html#formatComponentParser"><span class="hs-identifier">formatComponentParser</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">char</span><span> </span><span class="hs-char">'%'</span><span> </span><span class="hs-operator hs-var">*&gt;</span><span> </span><span class="hs-special">(</span><span> </span><a href="Data.Time.JapaneseCalendar.Format.html#percentParser"><span class="hs-identifier hs-var">percentParser</span></a><span>
</span><a name="line-104"></a><span>                                    </span><span class="hs-operator hs-var">&lt;|&gt;</span><span> </span><span class="hs-identifier hs-var">try</span><span> </span><a href="Data.Time.JapaneseCalendar.Format.html#yearNumParser"><span class="hs-identifier hs-var">yearNumParser</span></a><span>
</span><a name="line-105"></a><span>                                    </span><span class="hs-operator hs-var">&lt;|&gt;</span><span> </span><span class="hs-identifier hs-var">try</span><span> </span><a href="Data.Time.JapaneseCalendar.Format.html#leapMonthNameParser"><span class="hs-identifier hs-var">leapMonthNameParser</span></a><span>
</span><a name="line-106"></a><span>                                    </span><span class="hs-operator hs-var">&lt;|&gt;</span><span> </span><span class="hs-identifier hs-var">try</span><span> </span><a href="Data.Time.JapaneseCalendar.Format.html#monthNumParser"><span class="hs-identifier hs-var">monthNumParser</span></a><span>
</span><a name="line-107"></a><span>                                    </span><span class="hs-operator hs-var">&lt;|&gt;</span><span> </span><span class="hs-identifier hs-var">try</span><span> </span><a href="Data.Time.JapaneseCalendar.Format.html#monthFullNumParser"><span class="hs-identifier hs-var">monthFullNumParser</span></a><span>
</span><a name="line-108"></a><span>                                    </span><span class="hs-operator hs-var">&lt;|&gt;</span><span> </span><span class="hs-identifier hs-var">try</span><span> </span><a href="Data.Time.JapaneseCalendar.Format.html#monthNameParser"><span class="hs-identifier hs-var">monthNameParser</span></a><span>
</span><a name="line-109"></a><span>                                    </span><span class="hs-operator hs-var">&lt;|&gt;</span><span> </span><span class="hs-identifier hs-var">try</span><span> </span><a href="Data.Time.JapaneseCalendar.Format.html#monthFullNameParser"><span class="hs-identifier hs-var">monthFullNameParser</span></a><span>
</span><a name="line-110"></a><span>                                    </span><span class="hs-operator hs-var">&lt;|&gt;</span><span> </span><span class="hs-identifier hs-var">try</span><span> </span><a href="Data.Time.JapaneseCalendar.Format.html#dayNumParser"><span class="hs-identifier hs-var">dayNumParser</span></a><span>
</span><a name="line-111"></a><span>                                    </span><span class="hs-special">)</span><span>
</span><a name="line-112"></a><span>
</span><a name="line-113"></a><span class="hs-identifier">percentParser</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Parser</span><span> </span><a href="Data.Time.JapaneseCalendar.Format.html#Component"><span class="hs-identifier hs-type">Component</span></a><span>
</span><a name="line-114"></a><a name="percentParser"><a href="Data.Time.JapaneseCalendar.Format.html#percentParser"><span class="hs-identifier">percentParser</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Time.JapaneseCalendar.Format.html#StringComponent"><span class="hs-identifier hs-var">StringComponent</span></a><span> </span><span class="hs-string">&quot;%&quot;</span><span> </span><span class="hs-operator hs-var">&lt;$</span><span> </span><span class="hs-identifier hs-var">char</span><span> </span><span class="hs-char">'%'</span><span>
</span><a name="line-115"></a><span>
</span><a name="line-116"></a><span class="hs-identifier">yearNumParser</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Parser</span><span> </span><a href="Data.Time.JapaneseCalendar.Format.html#Component"><span class="hs-identifier hs-type">Component</span></a><span>
</span><a name="line-117"></a><a name="yearNumParser"><a href="Data.Time.JapaneseCalendar.Format.html#yearNumParser"><span class="hs-identifier">yearNumParser</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Time.JapaneseCalendar.Format.html#numParser"><span class="hs-identifier hs-var">numParser</span></a><span> </span><span class="hs-char">'y'</span><span> </span><a href="Data.Time.JapaneseCalendar.Format.html#YearNum"><span class="hs-identifier hs-var">YearNum</span></a><span>
</span><a name="line-118"></a><span>
</span><a name="line-119"></a><span class="hs-identifier">leapMonthNameParser</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Parser</span><span> </span><a href="Data.Time.JapaneseCalendar.Format.html#Component"><span class="hs-identifier hs-type">Component</span></a><span>
</span><a name="line-120"></a><a name="leapMonthNameParser"><a href="Data.Time.JapaneseCalendar.Format.html#leapMonthNameParser"><span class="hs-identifier">leapMonthNameParser</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Time.JapaneseCalendar.Format.html#nonePadParser"><span class="hs-identifier hs-var">nonePadParser</span></a><span> </span><span class="hs-char">'L'</span><span> </span><a href="Data.Time.JapaneseCalendar.Format.html#LeapMonthName"><span class="hs-identifier hs-var">LeapMonthName</span></a><span>
</span><a name="line-121"></a><span>
</span><a name="line-122"></a><span class="hs-identifier">monthNumParser</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Parser</span><span> </span><a href="Data.Time.JapaneseCalendar.Format.html#Component"><span class="hs-identifier hs-type">Component</span></a><span>
</span><a name="line-123"></a><a name="monthNumParser"><a href="Data.Time.JapaneseCalendar.Format.html#monthNumParser"><span class="hs-identifier">monthNumParser</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Time.JapaneseCalendar.Format.html#numParser"><span class="hs-identifier hs-var">numParser</span></a><span> </span><span class="hs-char">'m'</span><span> </span><a href="Data.Time.JapaneseCalendar.Format.html#MonthNum"><span class="hs-identifier hs-var">MonthNum</span></a><span>
</span><a name="line-124"></a><span>
</span><a name="line-125"></a><span class="hs-identifier">monthFullNumParser</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Parser</span><span> </span><a href="Data.Time.JapaneseCalendar.Format.html#Component"><span class="hs-identifier hs-type">Component</span></a><span>
</span><a name="line-126"></a><a name="monthFullNumParser"><a href="Data.Time.JapaneseCalendar.Format.html#monthFullNumParser"><span class="hs-identifier">monthFullNumParser</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Time.JapaneseCalendar.Format.html#numParser"><span class="hs-identifier hs-var">numParser</span></a><span> </span><span class="hs-char">'M'</span><span> </span><a href="Data.Time.JapaneseCalendar.Format.html#MonthFullNum"><span class="hs-identifier hs-var">MonthFullNum</span></a><span>
</span><a name="line-127"></a><span>
</span><a name="line-128"></a><span class="hs-identifier">monthNameParser</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Parser</span><span> </span><a href="Data.Time.JapaneseCalendar.Format.html#Component"><span class="hs-identifier hs-type">Component</span></a><span>
</span><a name="line-129"></a><a name="monthNameParser"><a href="Data.Time.JapaneseCalendar.Format.html#monthNameParser"><span class="hs-identifier">monthNameParser</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Time.JapaneseCalendar.Format.html#nonePadParser"><span class="hs-identifier hs-var">nonePadParser</span></a><span> </span><span class="hs-char">'b'</span><span> </span><a href="Data.Time.JapaneseCalendar.Format.html#MonthName"><span class="hs-identifier hs-var">MonthName</span></a><span>
</span><a name="line-130"></a><span>
</span><a name="line-131"></a><span class="hs-identifier">monthFullNameParser</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Parser</span><span> </span><a href="Data.Time.JapaneseCalendar.Format.html#Component"><span class="hs-identifier hs-type">Component</span></a><span>
</span><a name="line-132"></a><a name="monthFullNameParser"><a href="Data.Time.JapaneseCalendar.Format.html#monthFullNameParser"><span class="hs-identifier">monthFullNameParser</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Time.JapaneseCalendar.Format.html#nonePadParser"><span class="hs-identifier hs-var">nonePadParser</span></a><span> </span><span class="hs-char">'B'</span><span> </span><a href="Data.Time.JapaneseCalendar.Format.html#MonthFullName"><span class="hs-identifier hs-var">MonthFullName</span></a><span>
</span><a name="line-133"></a><span>
</span><a name="line-134"></a><span class="hs-identifier">dayNumParser</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Parser</span><span> </span><a href="Data.Time.JapaneseCalendar.Format.html#Component"><span class="hs-identifier hs-type">Component</span></a><span>
</span><a name="line-135"></a><a name="dayNumParser"><a href="Data.Time.JapaneseCalendar.Format.html#dayNumParser"><span class="hs-identifier">dayNumParser</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Time.JapaneseCalendar.Format.html#numParser"><span class="hs-identifier hs-var">numParser</span></a><span> </span><span class="hs-char">'d'</span><span> </span><a href="Data.Time.JapaneseCalendar.Format.html#DayNum"><span class="hs-identifier hs-var">DayNum</span></a><span>
</span><a name="line-136"></a><span>
</span><a name="line-137"></a><span class="hs-identifier">numParser</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Char</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Data.Time.JapaneseCalendar.Format.html#PadType"><span class="hs-identifier hs-type">PadType</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Time.JapaneseCalendar.Format.html#ComponentType"><span class="hs-identifier hs-type">ComponentType</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Parser</span><span> </span><a href="Data.Time.JapaneseCalendar.Format.html#Component"><span class="hs-identifier hs-type">Component</span></a><span>
</span><a name="line-138"></a><a name="numParser"><a href="Data.Time.JapaneseCalendar.Format.html#numParser"><span class="hs-identifier">numParser</span></a></a><span> </span><a name="local-6989586621679111006"><a href="#local-6989586621679111006"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679111007"><a href="#local-6989586621679111007"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Time.JapaneseCalendar.Format.html#FormatComponent"><span class="hs-identifier hs-var">FormatComponent</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679111007"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-special">(</span><a href="Data.Time.JapaneseCalendar.Format.html#modifierParser"><span class="hs-identifier hs-var">modifierParser</span></a><span> </span><span class="hs-operator hs-var">&lt;*</span><span> </span><span class="hs-identifier hs-var">char</span><span> </span><a href="#local-6989586621679111006"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-139"></a><span>
</span><a name="line-140"></a><span class="hs-identifier">modifierParser</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Parser</span><span> </span><a href="Data.Time.JapaneseCalendar.Format.html#PadType"><span class="hs-identifier hs-type">PadType</span></a><span>
</span><a name="line-141"></a><a name="modifierParser"><a href="Data.Time.JapaneseCalendar.Format.html#modifierParser"><span class="hs-identifier">modifierParser</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Data.Time.JapaneseCalendar.Format.html#ZeroPad"><span class="hs-identifier hs-var">ZeroPad</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">char</span><span> </span><span class="hs-char">'0'</span><span> </span><span class="hs-operator hs-var">*&gt;</span><span> </span><a href="Data.Time.JapaneseCalendar.Format.html#intParser"><span class="hs-identifier hs-var">intParser</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;|&gt;</span><span> </span><span class="hs-special">(</span><a href="Data.Time.JapaneseCalendar.Format.html#SpacePad"><span class="hs-identifier hs-var">SpacePad</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Data.Time.JapaneseCalendar.Format.html#intParser"><span class="hs-identifier hs-var">intParser</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;|&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="Data.Time.JapaneseCalendar.Format.html#NonePad"><span class="hs-identifier hs-var">NonePad</span></a><span>
</span><a name="line-142"></a><span>
</span><a name="line-143"></a><span class="hs-identifier">intParser</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Parser</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-144"></a><a name="intParser"><a href="Data.Time.JapaneseCalendar.Format.html#intParser"><span class="hs-identifier">intParser</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">read</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">satisfy</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679111039"><a href="#local-6989586621679111039"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679111039"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><span class="hs-char">'1'</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679111039"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><span class="hs-char">'9'</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;*&gt;</span><span> </span><span class="hs-identifier hs-var">many</span><span> </span><span class="hs-identifier hs-var">digit</span><span class="hs-special">)</span><span>
</span><a name="line-145"></a><span>
</span><a name="line-146"></a><span class="hs-identifier">nonePadParser</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Char</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Time.JapaneseCalendar.Format.html#ComponentType"><span class="hs-identifier hs-type">ComponentType</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Parser</span><span> </span><a href="Data.Time.JapaneseCalendar.Format.html#Component"><span class="hs-identifier hs-type">Component</span></a><span>
</span><a name="line-147"></a><a name="nonePadParser"><a href="Data.Time.JapaneseCalendar.Format.html#nonePadParser"><span class="hs-identifier">nonePadParser</span></a></a><span> </span><a name="local-6989586621679111040"><a href="#local-6989586621679111040"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679111041"><a href="#local-6989586621679111041"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Time.JapaneseCalendar.Format.html#FormatComponent"><span class="hs-identifier hs-var">FormatComponent</span></a><span> </span><a href="#local-6989586621679111041"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-operator hs-var">&lt;$</span><span> </span><span class="hs-identifier hs-var">char</span><span> </span><a href="#local-6989586621679111040"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-148"></a></pre></body></html>